<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>e-BIB Generator</title>

<link href="https://fonts.googleapis.com/css2?family=Anton&display=swap" rel="stylesheet">

<style>
  body {
    font-family: 'Anton', sans-serif;
    text-align: center;
    margin: 20px;
  }
  canvas {
    border: 1px solid #000;
    max-width: 100%;
  }
  #generateBtn {
    font-size: 20px;
    padding: 10px 20px;
    margin-top: 20px;
  }
</style>
</head>
<body>

<h1>e-BIB Generator</h1>

<input
  type="text"
  id="nameInput"
  placeholder="Enter your name"
  style="font-size:18px; padding:5px 10px;"
>
<button id="generateBtn">Generate e-BIB</button>

<br><br>

<canvas id="bibCanvas" width="1200" height="800"></canvas>

<script>
const templateSrc = 'assets/new_template.png'; // make sure filename matches
const canvas = document.getElementById('bibCanvas');
const ctx = canvas.getContext('2d');

let participants = [];

// Load masterlist
fetch('data/participants.json')
  .then(res => res.json())
  .then(data => participants = data);

document.getElementById('generateBtn').addEventListener('click', () => {
  const nameInput = document.getElementById('nameInput').value.trim();
  if (!nameInput) return;

  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const img = new Image();
  img.src = templateSrc;
  img.onload = () => {
    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

    const participant = participants.find(
      p => p.name.toLowerCase() === nameInput.toLowerCase()
    );

    const bibNumber = participant
      ? participant.bib
      : Math.floor(1000 + Math.random() * 9000);

    ctx.fillStyle = 'black';
    ctx.textAlign = 'center';

    // ðŸ”¹ UPDATED BIB NUMBER FONT SIZE
    ctx.font = '185px Anton';
    ctx.fillText(bibNumber, canvas.width / 2, canvas.height / 2 + 50);

    // Name
    ctx.font = '60px Anton';
    ctx.fillText(nameInput.toUpperCase(), canvas.width / 2, canvas.height / 2 + 250);
  };
});
</script>

</body>
</html>
